#+TITLE: embedding
#+STARTUP: showall hidestars indent inlineimages
#+PROPERTY: header-args:jupyter-python :session 2024人工智能学习-embedding :display text/plain

* 准备工作
1.确保您按照[[file:README-CN.md][README]]中的说明在环境中设置了API密钥

2.安装依赖包

#+begin_src jupyter-python :results none
  pip install tiktoken openai pandas matplotlib plotly scikit-learn numpy
#+end_src

* 1. 生成 Embedding (基于 text-embedding-ada-002 模型)
嵌入对于处理自然语言和代码非常有用，因为其他机器学习模型和算法（如聚类或搜索）可以轻松地使用和比较它们。

[[file:images/embedding-vectors.svg]]

** 亚马逊美食评论数据集(amazon-fine-food-reviews)
Source:[[https://www.kaggle.com/snap/amazon-fine-food-reviews][美食评论数据集]]

[[file:images/amazon-fine-food-reviews.png]]

该数据集包含截至2012年10月用户在亚马逊上留下的共计568,454条美食评论。为了说明目的，我们将使用该数据集的一个子集，其中包括最近1,000条评论。
这些评论都是用英语撰写的，并且倾向于积极或消极。每个评论都有一个产品ID、用户ID、评分、标题（摘要）和正文。

我们将把评论摘要和正文合并成一个单一的组合文本。模型将对这个组合文本进行编码，并输出一个单一的向量嵌入。

#+begin_src jupyter-python :results none
  # 导入 pandas 包。Pandas 是一个用于数据处理和分析的 Python 库
  # 提供了 DataFrame 数据结构，方便进行数据的读取、处理、分析等操作。
  import pandas as pd
  # 导入 tiktoken 库。Tiktoken 是 OpenAI 开发的一个库，用于从模型生成的文本中计算 token 数量。
  import tiktoken
#+end_src

*** 加载数据集

#+begin_src jupyter-python
input_datapath = "data/fine_food_reviews_1k.csv"
df = pd.read_csv(input_datapath, index_col=0)
df = df[["Time", "ProductId", "UserId", "Score", "Summary", "Text"]]
df = df.dropna()

# 将 "Summary" 和 "Text" 字段组合成新的字段 "combined"
df["combined"] = (
    "Title: " + df.Summary.str.strip() + "; Content: " + df.Text.str.strip()
)
df.head(2)
#+end_src

#+RESULTS:
#+begin_example
           Time   ProductId          UserId  Score  \
  0  1351123200  B003XPF9BO  A3R7JR3FMEBXQB      5   
  1  1351123200  B003JK537S  A3JBPC3WFUT5ZP      1   

                                               Summary  \
  0  where does one  start...and stop... with a tre...   
  1                                  Arrived in pieces   

                                                  Text  \
  0  Wanted to save some to bring to my Chicago fam...   
  1  Not pleased at all. When I opened the box, mos...   

                                              combined  
  0  Title: where does one  start...and stop... wit...  
  1  Title: Arrived in pieces; Content: Not pleased...  
#+end_example

#+begin_src jupyter-python
df["combined"]
#+end_src

#+RESULTS:
#+begin_example
  0      Title: where does one  start...and stop... wit...
  1      Title: Arrived in pieces; Content: Not pleased...
  2      Title: It isn't blanc mange, but isn't bad . ....
  3      Title: These also have SALT and it's not sea s...
  4      Title: Happy with the product; Content: My dog...
                               ...                        
  995    Title: Delicious!; Content: I have ordered the...
  996    Title: Good Training Treat; Content: My dog wi...
  997    Title: Jamica Me Crazy Coffee; Content: Wolfga...
  998    Title: Party Peanuts; Content: Great product f...
  999    Title: I love Maui Coffee!; Content: My first ...
  Name: combined, Length: 1000, dtype: object
#+end_example

*** Embedding 模型关键参数

#+begin_src jupyter-python :results none
# 模型类型
# 建议使用官方推荐的第二代嵌入模型：text-embedding-ada-002
embedding_model = "text-embedding-ada-002"
# text-embedding-ada-002 模型对应的分词器（TOKENIZER）
embedding_encoding = "cl100k_base"
# text-embedding-ada-002 模型支持的输入最大 Token 数是8191，向量维度 1536
# 在我们的 DEMO 中过滤 Token 超过 8000 的文本
max_tokens = 8000  
#+end_src

*** 将样本减少到最近的1,000个评论，并删除过长的样本

#+begin_src jupyter-python
# 设置要筛选的评论数量为1000
top_n = 1000
# 对DataFrame进行排序，基于"Time"列，然后选取最后的2000条评论。
# 这个假设是，我们认为最近的评论可能更相关，因此我们将对它们进行初始筛选。
df = df.sort_values("Time").tail(top_n * 2) 
# 丢弃"Time"列，因为我们在这个分析中不再需要它。
df.drop("Time", axis=1, inplace=True)
# 从'embedding_encoding'获取编码
encoding = tiktoken.get_encoding(embedding_encoding)

# 计算每条评论的token数量。我们通过使用encoding.encode方法获取每条评论的token数，然后把结果存储在新的'n_tokens'列中。
df["n_tokens"] = df.combined.apply(lambda x: len(encoding.encode(x)))

# 如果评论的token数量超过最大允许的token数量，我们将忽略（删除）该评论。
# 我们使用.tail方法获取token数量在允许范围内的最后top_n（1000）条评论。
df = df[df.n_tokens <= max_tokens].tail(top_n)

# 打印出剩余评论的数量。
len(df)
#+end_src

#+RESULTS:
: 1000

*** 生成 Embeddings 并保存

#+begin_src jupyter-python :results none
  from openai import OpenAI
#+end_src

#+begin_src jupyter-python :results none
  # OpenAI Python SDK v1.0 更新后的使用方式
  client = OpenAI(base_url='https://api.xty.app/v1')
#+end_src

#+begin_src jupyter-python
  # 新版本创建 Embedding 向量的方法
  # Ref：https://community.openai.com/t/embeddings-api-documentation-needs-to-updated/475663
  res = client.embeddings.create(input="abc", model=embedding_model)
  print(res.data[0].embedding)
#+end_src

#+RESULTS:
: [0.002615210600197315, -0.011296011507511139, -0.00963275134563446, -0.039097219705581665, -0.03448256105184555, 0.012145334854722023, -0.021303880959749222, -0.02280435338616371, 0.018685130402445793, -0.00038153232890181243, 0.0033760634250938892, 0.019194725900888443, -0.0026983735151588917, -0.004526189994066954, -0.018840840086340904, 0.0029708649963140488, 0.027093440294265747, 0.010666095651686192, 0.010800572112202644, 0.007530673872679472, -0.014537598006427288, 0.01776503026485443, -0.0069786133244633675, -0.01562756486237049, -0.020199758931994438, -0.003558314172551036, 0.009993714280426502, -0.020058205351233482, 0.026272427290678024, -0.007325420621782541, 0.00774300517514348, 0.013787361793220043, -0.007459897082298994, -0.009944169782102108, -0.010397142730653286, -0.014219101518392563, -0.013645808212459087, -0.015924828127026558, 0.010382987558841705, -0.00026408673147670925, 0.024347292259335518, 0.0045155733823776245, 0.014098781161010265, -0.022960063070058823, -0.012782328762114048, -0.011444643139839172, -0.017241280525922775, -0.015287834219634533, -0.024262359365820885, 0.01572665199637413, -0.007389120291918516, 0.0043846359476447105, -0.025890231132507324, -0.023087460547685623, 0.006684888619929552, -0.007474052254110575, 0.005103022791445255, 0.035331886261701584, 0.0025249698664993048, -0.010602395981550217, 0.0074315862730145454, 0.0067521268501877785, -0.01320699043571949, 0.008068579249083996, 0.00899575836956501, -0.02015729248523712, 0.0003324307908769697, 0.004756215028464794, -0.008394153788685799, 0.007530673872679472, 0.01789242774248123, 0.015938982367515564, 0.008040268905460835, -0.005219804588705301, 0.03043411485850811, -0.011458798311650753, -0.022054117172956467, 0.0006246071425266564, -0.010885504074394703, 0.01484901737421751, 0.004172304645180702, -0.023724455386400223, -0.00904530193656683, 0.013978459872305393, 0.007247566245496273, 0.020822597667574883, -0.0004136031784582883, -0.005283503793179989, -0.0013960765209048986, 0.000543655944056809, 0.025607122108340263, 0.0047279042191803455, 0.015273679047822952, 0.002765611745417118, -0.01572665199637413, -0.006561029236763716, -0.000593199860304594, 0.03187796473503113, 0.0040767560712993145, -0.04521235451102257, 0.020199758931994438, 0.013376855291426182, -0.02045455574989319, -0.01793489418923855, -0.020468711853027344, -0.03289715573191643, -0.005605539306998253, 0.004565117415040731, 0.03216107562184334, -0.010411298833787441, 0.006008968222886324, 0.0042289262637495995, 0.007693461142480373, -0.039578504860401154, 0.005555995274335146, 0.01151541993021965, -0.0026028247084468603, -0.015740808099508286, 0.0034309157636016607, -0.005191493779420853, 0.004458951763808727, 0.028664689511060715, 0.02781536616384983, -0.0031248051673173904, 0.018670976161956787, -0.0018685130635276437, -0.012039169669151306, -0.015641719102859497, 0.014311111532151699, 0.01046084240078926, 0.0396917499601841, 0.01562756486237049, 0.01659013144671917, 0.01694401726126671, -0.026838643476366997, 0.01598144881427288, -0.021813474595546722, 0.024517156183719635, -0.04671282693743706, -0.024545468389987946, -0.0055524567142128944, 0.035360194742679596, -0.020879218354821205, 0.009569051675498486, -0.0008608254138380289, 0.009094846434891224, 0.03397296741604805, 0.002877085469663143, -0.008075657300651073, -0.004363402724266052, 0.01334854494780302, -0.0230308398604393, 0.014403121545910835, 0.021431278437376022, -0.010920893400907516, 0.016377801075577736, 0.0073608094826340675, 0.0023037916980683804, -0.006822904106229544, -0.016391955316066742, -0.007049390580505133, 0.021261414512991905, 0.021586988121271133, -0.016830774024128914, 0.002547972369939089, -0.004441257566213608, 0.02921675145626068, 0.008394153788685799, -0.01610884815454483, -0.025946851819753647, -0.017538543790578842, 3.782146450248547e-05, -0.007127244956791401, -0.001010341802611947, -0.016123004257678986, 0.024389758706092834, -0.006638883613049984, 0.010333443991839886, -0.02593269757926464, -0.011989626102149487, -0.00022549113782588392, 0.01869928650557995, 0.013185757212340832, 0.02845235913991928, -0.01441727764904499, 0.006670733448117971, 0.01709972694516182, -0.020270535722374916, 0.022195670753717422, -0.032557424157857895, 0.0020330697298049927, 0.002670062705874443, 0.02083675190806389, -0.024998441338539124, -0.6858009099960327, -0.009774304926395416, 0.004055522847920656, -0.018133070319890976, 0.0073466538451612, 0.03201952204108238, 0.016193781048059464, 0.0005786020774394274, -0.021615300327539444, 0.004328014329075813, 0.010913815349340439, 0.00229671411216259, -0.0018313551554456353, -0.00036892518983222544, -0.00587803078815341, -0.01277525071054697, 0.010609474033117294, -0.015259523876011372, -0.0011262391926720738, 0.023950939998030663, -0.014905638992786407, 0.013822750188410282, -0.021261414512991905, -0.0056692385114729404, 0.019534455612301826, 0.0009581437916494906, 0.006872447673231363, -0.031056953594088554, -0.017779186367988586, -0.0031407298520207405, -0.012286889366805553, 0.0045509617775678635, 0.0011625124607235193, 0.023526279255747795, 0.045127421617507935, 0.012499220669269562, -0.015443543903529644, 0.020695198327302933, 0.021841786801815033, 0.028593912720680237, 0.0027939225547015667, -0.01510381419211626, 0.01671753078699112, 0.0034397628623992205, -0.013369777239859104, 0.00900991354137659, 0.013426398858428001, -0.0009028492495417595, 0.01108368020504713, -0.01847280003130436, 0.027631346136331558, -0.011833916418254375, -0.014933949336409569, -0.0021622376516461372, 0.024134961888194084, -0.009024068713188171, 0.024828575551509857, -0.0027709200512617826, -0.0012332894839346409, 0.008464930579066277, -0.009413342922925949, 0.007290032226592302, -0.004685438238084316, -0.040880803018808365, -0.018274623900651932, 0.0213746577501297, -0.015740808099508286, 0.01575496233999729, 0.033321816474199295, -0.017920739948749542, -0.011833916418254375, 0.007403275463730097, -0.0015199363697320223, -0.012223189696669579, 0.018515266478061676, 0.011642818339169025, 0.01926550269126892, 0.005453368648886681, -0.024587934836745262, 0.01051038596779108, 0.0006905182381160557, 0.012470909394323826, -0.008394153788685799, 0.01048207562416792, 0.022662799805402756, 0.013242378830909729, -0.027036817744374275, 0.004788064863532782, 0.013164523988962173, -0.01700063794851303, 0.02730577066540718, 0.028763778507709503, -0.005987734999507666, -0.011494186706840992, 0.014169557951390743, 0.01608053781092167, 3.502909021335654e-05, 0.008832971565425396, 0.00271960673853755, -0.03756843879818916, -0.009710606187582016, 0.0004341727471910417, 0.019959118217229843, -0.006419475190341473, 0.008592328988015652, -0.007077701389789581, 0.009894626215100288, 0.020723508670926094, 0.04778863862156868, -0.023823542520403862, -0.0076226843520998955, -0.0025302781723439693, -0.005315353628247976, -0.006493791006505489, 0.01605222560465336, -0.040965735912323, 0.008401230908930302, -0.008691417053341866, 0.01694401726126671, -0.015613408759236336, 0.011111990548670292, -0.0012288658181205392, 0.013723663054406643, 0.0039812070317566395, -0.010531619191169739, 0.010595318861305714, 0.004957929719239473, -0.0022825587075203657, -0.003404374234378338, -0.007417431101202965, -0.00263644359074533, 0.005237498786300421, 0.016802461817860603, -0.008691417053341866, 0.006642422638833523, 0.009944169782102108, 0.010290977545082569, -0.025196615606546402, 0.0057647875510156155, 0.0029956370126456022, -0.02656969055533409, -0.022790197283029556, -0.004766831640154123, -0.01150126475840807, -0.0022949445992708206, -0.026753710582852364, -0.02335641346871853, 0.000818359199911356, -0.011317243799567223, 0.008273832499980927, -0.023398879915475845, -0.005191493779420853, -0.007757160346955061, 0.032840535044670105, 0.0034397628623992205, -0.04229634255170822, 0.0076226843520998955, -0.022153204306960106, -0.003230970585718751, 0.025338171049952507, 0.024828575551509857, -0.0017853501485660672, -0.006164677906781435, 0.0197184756398201, 0.004628816619515419, -0.017793340608477592, 0.005149027798324823, -0.006341620348393917, -0.01809060387313366, -0.028282493352890015, 0.0012757556978613138, -0.03326519578695297, -0.0062673045322299, 0.024234049022197723, 0.0031283439602702856, 0.007856247946619987, -0.010772260837256908, 0.016774151474237442, 0.0150755038484931, 0.0001987285795621574, 0.0012589461402967572, 0.0057152435183525085, -0.007629761938005686, -0.009774304926395416, 0.025182461366057396, 0.009179778397083282, 0.011706518009305, 0.01613715849816799, -0.027319926768541336, 0.0024948897771537304, -0.007934102788567543, 0.010906737297773361, 0.010149423964321613, -0.0003963512717746198, -0.011055368930101395, -0.01051038596779108, 0.007842092774808407, 0.00587803078815341, 0.01684492826461792, 0.018543576821684837, 0.035388506948947906, 0.0038785801734775305, 0.01073687244206667, 0.01751023344695568, 0.011041213758289814, -0.023582899942994118, 0.00029040692606940866, -0.02450300194323063, 0.03436931595206261, 0.010524542070925236, -0.010198967531323433, -0.018826685845851898, -0.0041121444664895535, -0.01984587498009205, -0.01073687244206667, 0.03541681542992592, -0.024064183235168457, 0.004614660982042551, 0.022252293303608894, -0.006369931157678366, -0.012732784263789654, -0.00610097823664546, 0.002342719119042158, 0.027716277167201042, -0.00753775192424655, -0.0051454887725412846, -0.005828486755490303, -0.004869458265602589, -0.015259523876011372, -0.007934102788567543, -0.0001561517856316641, 0.007438663858920336, -0.000964336795732379, 0.01748192124068737, 0.006720277480781078, 0.0006967112421989441, 0.008875437080860138, -0.023526279255747795, 0.028225872665643692, -0.013475943356752396, 0.0062779211439192295, 0.02893364243209362, 0.02051117829978466, 0.0024842731654644012, 0.020426245406270027, -0.005559534300118685, 0.02315823920071125, 0.013249456882476807, -0.007311265449970961, 0.006638883613049984, -0.012916804291307926, 0.000399447773816064, -0.040371209383010864, 0.03017931804060936, 0.011027058586478233, 0.006953841540962458, 0.02015729248523712, 0.013730740174651146, 0.01595313847064972, 0.023214859887957573, 0.0070246183313429356, 0.014679152518510818, 0.0034786900505423546, 0.00303456443361938, 0.019449522718787193, 0.004282009322196245, 0.004412946756929159, -0.02335641346871853, -0.019605232402682304, -0.017340367659926414, 0.00567985512316227, -0.03221769630908966, -0.01913810335099697, -0.011090758256614208, 0.017496077343821526, -0.024290669709444046, -0.03606796637177467, 0.006090362090617418, 0.019378745928406715, -0.016759997233748436, -0.00437755836173892, -0.02191256359219551, 0.0038007255643606186, 0.01694401726126671, -0.0027479175478219986, -0.015146280638873577, -0.0003709157754201442, 0.004543884191662073, -0.03465242683887482, 0.01974678598344326, -0.007856247946619987, -0.008592328988015652, 0.0022878670133650303, 0.005594922695308924, 0.004306781105697155, -0.003977668005973101, 0.010694406926631927, -0.01020604558289051, -0.035105399787425995, -0.012223189696669579, -0.008733883500099182, -0.02651306800544262, -0.006012507248669863, -0.015401077456772327, 0.0432589091360569, 0.0037901089526712894, -0.004444796591997147, -0.020213915035128593, -0.02066688798367977, 0.0022595562040805817, -0.012272734194993973, 0.008259677328169346, -0.024234049022197723, 0.0016429113456979394, -0.004487262573093176, -0.008203055709600449, -0.01872759684920311, -0.009243478067219257, 0.034878913313150406, -0.008075657300651073, -0.02318654954433441, -0.003726409748196602, -0.014360656030476093, -0.003294670023024082, 0.05744262412190437, 0.013426398858428001, -0.006019584834575653, 0.024743642657995224, -0.009915859438478947, 0.018232157453894615, -0.008068579249083996, -0.0032522038090974092, 0.020015738904476166, -0.002224167576059699, 0.008797582238912582, -0.0046818992123007774, 0.019676009193062782, 0.004604044836014509, 0.006387625355273485, 0.03269898146390915, 0.0022029345855116844, -0.019661853089928627, 0.029075196012854576, 0.0032468955032527447, -0.01585405133664608, -0.01402092631906271, 0.032047830522060394, 0.03700222074985504, -0.009002835489809513, -0.01339808851480484, -0.011763139627873898, 0.01961938850581646, 0.006316848564893007, -0.03303870931267738, -0.008224288932979107, 0.011883459985256195, 0.01681661792099476, 0.03122681751847267, 0.03717208653688431, 0.018133070319890976, 0.007244027219712734, -0.00898160319775343, 0.005467524286359549, -0.012923882342875004, 0.03541681542992592, 0.017283746972680092, -0.006320387125015259, -0.02727746032178402, -9.351689186587464e-06, -0.00714493915438652, -0.025338171049952507, 0.016307024285197258, 0.0043846359476447105, -0.010913815349340439, 0.02453131228685379, 0.0013615727657452226, -0.02814093977212906, 0.002604593988507986, -0.005782481748610735, 0.013596263714134693, -0.017906583845615387, -0.00875511672347784, 0.012463832274079323, -0.018614353612065315, -0.018104759976267815, -0.017779186367988586, 0.007636839523911476, 0.01872759684920311, -0.011671129614114761, -0.019251346588134766, -0.015217057429254055, 0.010751028545200825, -0.007261721417307854, -0.013893527910113335, 0.004869458265602589, -0.01913810335099697, -0.02692357450723648, 0.0003996689338237047, 0.01997327245771885, 0.0017499616369605064, 0.024035872891545296, -0.012881415896117687, 0.003768875962123275, 0.02124725840985775, -0.022790197283029556, -0.020850908011198044, 0.002988559426739812, -0.029839588329195976, -0.024361448362469673, 0.01745361089706421, 0.01483486220240593, -0.007325420621782541, 0.005053478758782148, 0.02788614295423031, -0.0003293342888355255, -0.012513375841081142, 0.038587626069784164, 0.002900087973102927, 0.015245368704199791, -0.005892186425626278, 0.013107902370393276, 0.021431278437376022, -0.017297901213169098, -0.016788307577371597, 0.005524145904928446, -0.011890538036823273, 0.013369777239859104, -0.002440037438645959, 0.010552852414548397, -0.006904297508299351, 0.02969803474843502, 0.021544521674513817, -0.01460837572813034, -0.015372767113149166, 0.025408947840332985, -0.03391634300351143, 0.0016393725527450442, -0.005952346604317427, -0.0033583692274987698, 0.005527684465050697, 0.013299000449478626, 0.004788064863532782, 0.0016181394457817078, -0.01770840771496296, 0.0013916529715061188, -0.024517156183719635, 0.03068891167640686, 0.01997327245771885, -0.025224927812814713, 0.01707141473889351, 0.0016261019045487046, -0.01108368020504713, -0.01595313847064972, -0.009972481057047844, 0.0018578965682536364, 0.012400132603943348, -0.01368827372789383, -0.02290344052016735, -0.05203526094555855, -0.005396747030317783, -0.0029248599894344807, 0.06035863608121872, -0.002279019681736827, -0.006161138880997896, -0.021162327378988266, 0.018161380663514137, 0.005725860130041838, -0.008103967644274235, -0.01659013144671917, -0.04209816828370094, -0.0055383010767400265, 0.001467738300561905, -0.0029372461140155792, 0.019605232402682304, 0.0016499890480190516, 0.014565909281373024, -0.01277525071054697, 0.00799072440713644, -0.02236553654074669, -0.022280603647232056, -0.015061347745358944, -0.022634487599134445, 0.023950939998030663, 0.02165776491165161, 0.03796479105949402, 0.004140455275774002, 0.004313858691602945, 0.024488845840096474, -0.009880471043288708, 0.011487108655273914, 0.009838004596531391, 0.01697232760488987, -0.03553006052970886, -0.0011120837880298495, 0.026810333132743835, -0.0034857678692787886, 0.011572041548788548, -0.012513375841081142, 0.021558677777647972, 0.02654138021171093, 0.001751731033436954, -0.03363323584198952, -0.0024488845374435186, 0.0043244753032922745, -0.016321178525686264, -0.015316145494580269, -0.007481130305677652, 0.030264250934123993, -0.025508034974336624, 0.0022507088724523783, 0.026866953819990158, 0.030887087807059288, 0.009215166792273521, -0.021063238382339478, 0.05517775937914848, 0.007707616779953241, 0.020879218354821205, 0.008677261881530285, -0.005499373655766249, -0.01860019937157631, -0.007877481169998646, 0.006373469717800617, -0.010524542070925236, 0.012350589036941528, 0.018288780003786087, 0.032359249889850616, -0.003195582190528512, -0.006985690910369158, -0.01261954102665186, 0.003825497580692172, -0.00198175641708076, -0.015018882229924202, 0.011140301823616028, -0.010029102675616741, 0.0008966562454588711, -0.013065436854958534, -0.016193781048059464, -0.04297580197453499, -0.00442710192874074, 7.630646723555401e-05, 0.0008709995890967548, 0.016278712078928947, -0.008641873486340046, -0.030235938727855682, -0.0016641444526612759, -0.007417431101202965, 0.023441346362233162, -0.018614353612065315, 0.008365842513740063, 0.013737818226218224, 0.006493791006505489, -0.006603495217859745, 0.0023303332272917032, -0.02715006098151207, -0.024474691599607468, 0.02063857764005661, 0.021969184279441833, 0.003000945318490267, -0.007311265449970961, 0.0015783273847773671, 0.022507090121507645, -0.018232157453894615, -0.024092495441436768, 0.0298962090164423, 0.02140296809375286, 0.0008594983373768628, -0.024517156183719635, -0.011487108655273914, -0.017439456656575203, 0.017014794051647186, -0.007813782431185246, -0.004919002298265696, -0.025083372369408607, -0.03125512972474098, -0.010354677215218544, 0.01898239552974701, -0.010538697242736816, 0.027772899717092514, 0.028211716562509537, -0.012591230683028698, 0.00813227891921997, -0.010595318861305714, -0.00610097823664546, 0.005251654423773289, -0.010298055596649647, 0.03150992467999458, -0.016604287549853325, 6.104517524363473e-05, 0.022252293303608894, -0.008011957630515099, -0.03394465520977974, -0.0193362794816494, 0.00854986347258091, 0.029273372143507004, -0.023271482437849045, -0.0067521268501877785, 0.012994659133255482, 0.0012456753756850958, 0.017113881185650826, -0.0023073304910212755, -0.0206102654337883, -0.025437258183956146, -0.031821344047784805, -0.01319283526390791, 0.019633542746305466, 0.009852159768342972, -0.00898160319775343, -0.014778240583837032, 0.017807496711611748, -0.01189761608839035, -0.003100033150985837, 0.0010386526118963957, 0.0010625398717820644, -0.008210133761167526, -0.015386922284960747, 0.003829036373645067, 0.006670733448117971, 0.018203847110271454, -0.0028470053803175688, -0.005474601872265339, 0.004182921256870031, 0.015160435810685158, -0.019039016216993332, 0.02463039942085743, -0.015245368704199791, 0.011706518009305, -0.020369624719023705, 0.009625673294067383, -0.0034132213331758976, -0.01588236168026924, 0.0034132213331758976, -0.019223036244511604, -0.033067021518945694, -0.01834540069103241, -0.009901704266667366, 0.012407210655510426, 0.013419321738183498, -0.012166568078100681, 0.003857347182929516, 0.004448335152119398, 0.005088867153972387, -0.010439609177410603, -0.026838643476366997, 0.0017066106665879488, -0.019378745928406715, 0.008882515132427216, 0.018586043268442154, 1.8578964954940602e-05, 0.016349490731954575, -0.002670062705874443, 0.010963358916342258, -0.0004383751074783504, -0.02590438723564148, -0.010899660177528858, 0.008450775407254696, 0.02733408287167549, -0.0121524129062891, -0.03179303556680679, -0.0028133862651884556, -0.002631135517731309, -0.019449522718787193, 0.02562127821147442, -0.004002440255135298, -0.01661844179034233, -0.011649896390736103, -0.006822904106229544, 0.004894230514764786, 0.0005940845585428178, -0.013900605030357838, -0.011621585115790367, 0.00208084424957633, -0.01872759684920311, -0.03720039874315262, 0.018840840086340904, -0.009257633239030838, 0.01384398341178894, 0.007240488193929195, -0.018515266478061676, -0.022889286279678345, 0.010609474033117294, -0.030773844569921494, 0.006136367097496986, -0.0197184756398201, 0.024616245180368423, 0.01582573913037777, 0.0037370261270552874, -0.0034592265728861094, 0.05005350336432457, 0.008585251867771149, 0.013214068487286568, -0.013631652109324932, -0.016066381707787514, 0.011579119600355625, -0.001386344782076776, -0.0018313551554456353, -0.03040580451488495, -0.026810333132743835, -0.010935048572719097, 0.02310161665081978, 0.00010893024591496214, 0.015132125467061996, 0.019732631742954254, -0.0006639768253080547, -0.011699439957737923, -0.01582573913037777, 0.017043104395270348, 0.015839895233511925, -0.010814727284014225, 0.010998747311532497, -0.03451086953282356, 0.009144390001893044, 0.0019499066984280944, 0.010595318861305714, -0.000652917951811105, 0.0011925926664844155, -0.0026187493931502104, -0.0037511815316975117, 0.010574085637927055, 0.0008900209213607013, -0.008188900537788868, 0.009951247833669186, -0.006019584834575653, -0.003483998356387019, 0.02363952249288559, -0.015273679047822952, 0.022662799805402756, 0.006366392131894827, -0.002132157562300563, -0.000904618704225868, 0.005258732009679079, -0.028353270143270493, -0.009866315871477127, 0.01572665199637413, -0.009335488080978394, 0.001505780965089798, -0.03371816873550415, -0.004147532861679792, -0.01898239552974701, -0.0034362238366156816, -0.003284053411334753, -0.02501259557902813, 0.008054424077272415, 0.0430041141808033, 0.0021268492564558983, -0.029811277985572815, -0.004466029349714518, 0.0032486647833138704, -0.0005038438830524683, -0.0007077701156958938, -0.0017614628886803985, -0.0009156775777228177, -0.017750874161720276, -3.560968252713792e-05, 0.008089812472462654, -0.03618120774626732, -0.0013235301012173295, -0.013107902370393276, 0.016575975343585014, 0.004356325138360262, 0.005994813051074743, 0.17575347423553467, -0.02816925011575222, -0.013497176580131054, 0.03170810267329216, -0.011678206734359264, 0.005743554327636957, 0.010220200754702091, 0.007045851554721594, 0.004430640954524279, 0.01063778530806303, -0.01869928650557995, -0.009151468053460121, -0.017156347632408142, 0.016788307577371597, 0.004094450268894434, -0.005786020774394274, -0.023073306307196617, -0.023144083097577095, -0.02399340644478798, 0.0034202991519123316, 0.023214859887957573, -0.0060514346696436405, -0.01363873016089201, -0.016887394711375237, 0.032302629202604294, 0.012789405882358551, -0.009958325885236263, 0.008457852527499199, 0.013306078501045704, 0.004540345165878534, -0.005375514272600412, -0.013129135593771935, -0.008252599276602268, 0.019888339564204216, -0.007261721417307854, -0.02328563667833805, 0.0014571216888725758, 0.007438663858920336, 0.014332344755530357, 0.005092406179755926, -0.007095395587384701, -0.0018278163624927402, -0.013143290765583515, -0.016193781048059464, -0.002539125271141529, 0.021445434540510178, -0.013907683081924915, -0.013964304700493813, 0.015273679047822952, 0.020327158272266388, -0.03844607248902321, -0.004267853684723377, -0.0010289207566529512, 0.01384398341178894, 0.008910825476050377, 0.00041891145519912243, 0.02857975661754608, 0.001451813499443233, 0.005386130418628454, 0.023582899942994118, 0.0022949445992708206, 0.01626455783843994, -0.003510539885610342, 0.03252911567687988, -0.029867898672819138, 0.022054117172956467, -0.02437560260295868, -0.012598307803273201, 0.01358918659389019, -0.01872759684920311, -0.011529575102031231, -0.007969491183757782, -0.006054973229765892, 0.018161380663514137, -0.03550174832344055, -0.023370569571852684, 0.02644229121506214, 0.0250692181289196, 0.015924828127026558, 0.029867898672819138, 0.0021923179738223553, 0.026994353160262108, 0.008019035682082176, -0.007438663858920336, -0.0019959118217229843, -0.024871041998267174, 0.007474052254110575, 0.0298962090164423, -0.01218780130147934, -0.004423563368618488, 0.009285943582654, -0.02348381280899048, -0.005984196439385414, -0.01494810450822115, 0.022577866911888123, 0.008648950606584549, -0.005233960226178169, 0.03414282947778702, -0.019152259454131126, 0.0054427520371973515, -0.017142191529273987, 0.015415233559906483, 0.002708990126848221, 0.009519508108496666, -0.0004310762451495975, 0.001912748790346086, -0.011840994469821453, 0.010807650163769722, 0.008464930579066277, 0.013178680092096329, -0.021190637722611427, -0.023781076073646545, 0.005697549320757389, 0.013836906291544437, 0.01046084240078926, 0.012817717157304287, 0.0009245247347280383, -0.016958171501755714, 0.010283899493515491, -0.007374964654445648, -0.012293967418372631, -0.02229475975036621, 0.004692515823990107, -0.00081260857405141, 0.017014794051647186, 0.0016782998573035002, -0.032840535044670105, -0.013702429831027985, 0.0017543851863592863, -0.023851852864027023, -0.005736476741731167, 0.013525486923754215, -0.0013191065518185496, -0.01194715965539217, -0.0002837715728674084, 0.013405166566371918, -0.007247566245496273, -0.015160435810685158, -0.01913810335099697, -0.0026488297153264284, -0.007509441114962101, -0.006543334573507309, -0.002102077240124345, 0.003814880969002843, -0.006228377111256123, -0.016675064340233803, 0.029499858617782593, -0.0021516212727874517, -0.017297901213169098, -0.014565909281373024, -0.024729488417506218, -0.0113243218511343, -0.015500165522098541, -0.0013199913082644343, 0.01885499618947506, -0.0024064183235168457, -0.02654138021171093, -0.03623782843351364, 0.003588394494727254, 0.012860182672739029, -0.03479398041963577, -0.007290032226592302, 0.04056938365101814, -0.001617254689335823, -0.018543576821684837, -0.01709972694516182, -0.18707780539989471, 0.03196289762854576, 0.0018083526520058513, -0.030632290989160538, 0.028155095875263214, 0.009307176806032658, 0.020213915035128593, -0.0035282340832054615, -0.026810333132743835, -0.002459501149132848, 0.006631806027144194, -0.015188747085630894, -0.034284383058547974, 0.012881415896117687, 0.0032468955032527447, -0.016222091391682625, -0.010283899493515491, 0.0150755038484931, 0.005425057839602232, 0.01334854494780302, 0.015231212601065636, -0.017552699893712997, 0.0027939225547015667, 4.6060351451160386e-05, 0.0019835256971418858, -0.001763232285156846, -0.010871348902583122, 0.014622530899941921, -0.012194879353046417, -0.005244576372206211, -0.016929861158132553, -0.0055170683190226555, 0.013759051449596882, -0.001912748790346086, 0.001751731033436954, 0.0018932850798591971, -0.021969184279441833, -0.011600351892411709, -0.0037441039457917213, 0.023781076073646545, 0.0101140346378088, 0.01067317370325327, 0.008592328988015652, -0.011890538036823273, -0.004756215028464794, 0.028877021744847298, 0.022507090121507645, -0.010085724294185638, 0.04093742370605469, -0.004331553354859352, -0.0101140346378088, -0.001686262316070497, 0.009944169782102108, 0.003199120983481407, 0.014268646016716957, 0.012364744208753109, 0.004614660982042551, 0.009293021634221077, -0.01786411739885807, -0.0017641170416027308, 0.008111045695841312, -0.037115465849637985, 0.018586043268442154, -0.01086427178233862, -0.007254643831402063, -0.030858777463436127, 0.011366788297891617, -0.0005555995739996433, -0.024587934836745262, 0.017312057316303253, 0.0017366909887641668, -0.020242225378751755, 0.011423409916460514, -0.0447876937687397, 0.007891637273132801, -0.006423013750463724, -0.02631489373743534, 0.017949050292372704, 0.01403508149087429, -0.020327158272266388, -0.002946093212813139, 0.05732937902212143, 0.00503932312130928, -0.01585405133664608, -0.015273679047822952, 0.013037125580012798, -0.010680250823497772, -0.0014580064453184605, 0.007665150333195925, -0.0437685027718544, 0.02121894806623459, -0.006992768961936235, -0.017425300553441048, -0.012180724181234837, 0.018274623900651932, 0.026470603421330452, -0.005740015767514706, 0.0027036818210035563, 0.0044801849871873856, -0.0039458186365664005, 0.014622530899941921, 0.007003385573625565, -0.0004242197028361261, 0.014537598006427288, 0.02730577066540718, -0.0018578965682536364, -0.008896670304238796, 0.00854986347258091, 0.02727746032178402, 0.014594219624996185, -0.020327158272266388, 0.024644555523991585, 0.03671911358833313, 0.02252124436199665, -0.0014783547958359122, 0.0018649742705747485, -0.006242532283067703, -0.012902649119496346, 0.008705572225153446, -0.011720673181116581, 0.031085263937711716, -0.003860885975882411, -0.019704319536685944, 0.0068476758897304535, -0.0010439609177410603, -0.0011120837880298495, -0.10746781527996063, -0.03150992467999458, 0.0008510935585945845, 0.024828575551509857, -0.0021516212727874517, 0.0062673045322299, -0.019789252430200577, 0.021940873935818672, -0.01964769884943962, 0.03117019683122635, 0.01116861216723919, -0.0013836906291544437, 0.0012341741239652038, -0.006012507248669863, 0.03201952204108238, 0.0029443236999213696, -0.006561029236763716, 0.007948258891701698, -0.014778240583837032, 0.020313002169132233, -0.006925530731678009, 0.0034415321424603462, 0.002939015394076705, -0.005495835095643997, 0.017849963158369064, 0.012548764236271381, -0.02236553654074669, 0.029782967641949654, 0.016448577865958214, 0.02172854356467724, 0.004250159487128258, -0.039153844118118286, 0.01821800321340561, -0.03414282947778702, -0.011395098641514778, -0.0030752611346542835, -0.017552699893712997, -0.009852159768342972, 0.020907528698444366, -0.03521864116191864, 0.03292546421289444, 0.0027072206139564514, 0.01850111037492752, -0.031283438205718994, 0.011296011507511139, -0.010439609177410603, -0.010793494060635567, 0.010850115679204464, 0.00040453486144542694, -0.034312695264816284, -0.032330937683582306, -0.0036485549062490463, -0.011713595129549503, -0.0010315749095752835, 0.024644555523991585, -0.012647852301597595, 0.009703528136014938, 0.02992452122271061, -0.015839895233511925, 0.028027696534991264, -0.007236949633806944, -0.011706518009305, -0.0032893617171794176, 0.03722870722413063, -0.00713078398257494, 0.0008028767188079655, -0.0218842513859272, 0.009526586160063744, -0.001817199750803411, -0.03592641279101372, 0.007268799003213644, 0.01051038596779108, -0.034284383058547974, 0.03872917965054512, -0.033548302948474884, -0.006246071308851242, -0.009802616201341152, -0.007877481169998646, 0.025635434314608574, -0.01613715849816799, -0.010722717270255089, -0.01809060387313366, 0.0021640071645379066, -0.01712803728878498, 0.01712803728878498, 0.0011386252008378506, -0.004044906236231327, -0.0019888340029865503, -0.010843038558959961, -0.013086669147014618, 0.003253973089158535, 0.030802154913544655, 0.022450467571616173, 0.0012094022240489721, -0.01422617956995964, 0.010821805335581303, -0.020695198327302933, -0.015301990322768688, -0.002687757136300206, 0.010375910438597202, -0.02092168480157852, -0.019605232402682304, -0.09308592975139618, 0.01936458982527256, -0.0002654138079378754, -0.015839895233511925, 0.008825893513858318, -0.003942279610782862, 0.013299000449478626, -0.012456754222512245, -0.011402176693081856, -0.015797428786754608, -0.01952029950916767, 0.015231212601065636, -0.013136213645339012, -0.009116078726947308, 0.006840598303824663, -0.02463039942085743, 0.02758887968957424, 0.021643610671162605, 0.009979559108614922, 0.013454710133373737, 0.019194725900888443, 3.6107336200075224e-05, 0.02038377895951271, -0.0004843801725655794, -0.01869928650557995, 0.014962260611355305, -0.001179322018288076, 0.004483723547309637, 0.0016951094148680568, -0.011529575102031231, 0.009130234830081463, -0.011840994469821453, -0.02211073786020279, 0.004972084891051054, -0.007222793996334076, -0.00944165326654911, 0.0005675431457348168, 0.012987582013010979, -0.00026452908059582114, 0.011982548050582409, -0.012647852301597595, -0.015316145494580269, 0.002613441087305546, -0.017340367659926414, -0.0009377953829243779, -0.0061823721043765545, -0.017566854134202003, 0.03187796473503113, 0.002208242891356349, -0.009031146764755249, -0.008762193843722343, 0.022535400465130806, -0.0005122486036270857, -0.016193781048059464, -0.012166568078100681, -0.020072361454367638, 0.002673601731657982, -0.014962260611355305, -0.007481130305677652, -0.024064183235168457, 0.006815826054662466, 0.018076449632644653, 0.030264250934123993, -0.009922937490046024, 0.00856401864439249, -0.0005507336463779211, -0.0146933076903224, -0.009300099685788155, 0.0018110068049281836, -0.03453918173909187, -0.014580064453184605, -0.0005923151038587093, -0.013263612054288387, 0.011097835376858711, 0.007063545752316713, 0.0018154303543269634, 0.005141949746757746, 0.018798373639583588, 0.00523042120039463, 0.02102077193558216, 0.008210133761167526, 0.0021339268423616886, -0.040342897176742554, 0.016859084367752075, 0.01831709034740925, 0.013376855291426182, 0.0018101220484822989, -0.0004352786345407367, -0.006090362090617418, 0.010489152744412422, -0.012223189696669579, 0.012477987445890903, -0.01745361089706421, -0.0030133312102407217, 0.007148478180170059, 0.0031478076707571745, 0.011331399902701378, -0.026428136974573135, 0.011317243799567223, 0.022153204306960106, 0.011642818339169025, 0.008337532170116901, 0.00521626602858305, -0.028494825586676598, -0.013164523988962173, 0.010998747311532497, -0.014580064453184605, -0.029301682487130165, -0.0044801849871873856, 0.014509287662804127, 0.030264250934123993, 0.007849170826375484, 0.00670612184330821, 0.014551754109561443, -0.006479635369032621, 0.008443697355687618, -0.0068618315272033215, 0.0016818387666717172, -0.027843676507472992, 0.03244418278336525, 0.0013960765209048986, 0.025281548500061035, 0.0045155733823776245, 0.015613408759236336, 0.006879525724798441, 0.017524387687444687, 0.017297901213169098, -0.013320233672857285, -0.009080690331757069, -0.01212410256266594, 0.009717683307826519, -0.02916012890636921, -0.018104759976267815, -0.004720826633274555, -0.025706211104989052, -0.01926550269126892, 0.012131179682910442, 0.02689526416361332, -0.013822750188410282, 0.04971377179026604, 0.01659013144671917, -0.011472953483462334, 0.027390703558921814, -0.0018685130635276437, 0.02293175272643566, 0.017694253474473953, 0.00753775192424655, -0.022889286279678345, 0.0013270690105855465, 0.02239384688436985, 0.013511331751942635, -0.008457852527499199, -0.019676009193062782, -0.008479085750877857, -0.015868205577135086, -0.006458402145653963, 0.012364744208753109, -0.02000158280134201, 0.0005914304056204855, -0.0033088254276663065, 0.01116861216723919, 0.018897462636232376, 0.013263612054288387, -0.013766128569841385, -0.004961468745023012, 0.005938191432505846, 0.0113243218511343, -0.011097835376858711, -0.015811584889888763, 0.005074711982160807, 0.0058744922280311584, -0.018642665818333626, -0.04458951950073242, 0.02277604304254055, -0.015457699075341225, 0.0006117788143455982, -0.00480929808691144, 0.0036980989389121532, 0.020935840904712677, -0.001221788115799427, 0.015585098415613174, -0.028056006878614426, -0.023455502465367317, -0.00200652820058167, -0.005980657413601875, -0.022351380437612534, -0.0100503358989954, -0.015670031309127808]

#+begin_src jupyter-python :results none
  # 使用新方法调用 OpenAI Embedding API
  def embedding_text(text, model="text-embedding-ada-002"):
      res = client.embeddings.create(input=text, model=model)
      return res.data[0].embedding
#+end_src

** 注意：如果未使用信用卡支付过 OpenAI 账单的同学，可以直接跳过此步骤。
** COMMENT 提醒：非必须步骤，可直接复用项目中的嵌入文件 fine_food_reviews_with_embeddings_1k
对于免费试用用户的前48小时，OpenAI 设置了
[[https://platform.openai.com/docs/guides/rate-limits/overview][速率限制]]

如果你已经支付过 OpenAI API 账单，可以尝试取消注释，调用以下代码测试批量
Embedding：

#+begin_src jupyter-python
  # 实际生成会耗时几分钟，逐行调用 OpenAI Embedding API

  # df["embedding"] = df.combined.apply(embedding_text)
  # output_datapath = "data/fine_food_reviews_with_embeddings_1k_1126.csv"
  # df.to_csv(output_datapath)
#+end_src

#+begin_src jupyter-python
  # e0 = df["embedding"][0]
#+end_src

#+begin_src jupyter-python
  # e0
#+end_src

* 2. 读取 fine_food_reviews_with_embeddings_1k 嵌入文件

#+begin_src jupyter-python :results none
  embedding_datapath = "data/fine_food_reviews_with_embeddings_1k.csv"

  df_embedded = pd.read_csv(embedding_datapath, index_col=0)
#+end_src

*** 查看 Embedding 结果

#+begin_src jupyter-python 
  df_embedded["embedding"]
#+end_src

#+RESULTS:
#+begin_example
  12     [-0.0005399271612986922, -0.004124758299440145...
  13     [0.0068963742814958096, 0.0167608093470335, -0...
  14     [-0.0023715533316135406, -0.021357767283916473...
  15     [0.00226533692330122, 0.010306870564818382, 0....
  16     [-0.027459919452667236, -0.009041198529303074,...
                               ...                        
  447    [0.00796585250645876, 0.0017102764686569571, 0...
  436    [0.001777207711711526, -0.011673098430037498, ...
  437    [-0.005498920567333698, -0.014834611676633358,...
  438    [-0.00294404081068933, -0.007058987859636545, ...
  439    [-0.006043732166290283, -0.000693734094966203,...
  Name: embedding, Length: 1000, dtype: object
#+end_example
#+begin_src jupyter-python
len(df_embedded["embedding"][0])
#+end_src

#+RESULTS:
: 34410
#+begin_src jupyter-python
type(df_embedded["embedding"][0])
#+end_src

#+RESULTS:
: str
#+begin_src jupyter-python
df_embedded["embedding"][0]
#+end_src

#+RESULTS:
| 0.007060592994093895 | -0.02732112631201744 | 0.010580576956272125 | -0.014588683843612671 | 0.004358730278909206 | 0.019923659041523933 | 0.0006634345045313239 | -0.02212364971637726 | -0.01926366239786148 | -0.013578063808381557 | 0.018067417666316032 | 0.004080294165760279 | -0.032944850623607635 | 0.00016059498011600226 | 0.015798678621649742 | 0.019414912909269333 | 0.017888668924570084 | -0.026317380368709564 | -0.019387412816286087 | -0.025107385590672493 | -0.047382283955812454 | -0.00719809252768755 | 0.023828642442822456 | -0.008463086560368538 | -0.008923709392547607 | 0.011433073319494724 | 0.02945236675441265 | -0.02250864915549755 | -0.010174954310059547 | 0.02161490172147751 | 0.001189369591884315 | 0.00905433390289545 | -0.013364939950406551 | -0.017421171069145203 | -0.005912473425269127 | -0.01095182541757822 | -0.02648238092660904 | 0.007328717038035393 | 0.022481149062514305 | -0.02023990824818611 | 0.01907116360962391 | -0.015303680673241615 | 0.009205583482980728 | -0.00831183698028326 | 0.0017196015687659383 | 0.019511161372065544 | -0.015482430346310139 | -0.033219851553440094 | -0.014561183750629425 | 0.013268689624965191 | 0.03569483757019043 | 0.004131856374442577 | -0.04163481295108795 | 0.004231543280184269 | 0.004712791182100773 | 0.017379920929670334 | -0.019181163981556892 | -0.0010664795991033316 | 0.011013700626790524 | -0.028957368806004524 | -0.00012439396232366562 | 0.030497362837195396 | -0.041277311742305756 | 0.013186190277338028 | 0.007067468017339706 | -0.02073490619659424 | -0.0014317122986540198 | 0.015317430719733238 | -0.01342681422829628 | -0.005156226456165314 | 0.007754964753985405 | 0.0067924694158136845 | -0.002138115232810378 | 0.002724206540733576 | 0.005884973332285881 | -0.005582474637776613 | -0.018672415986657143 | -0.0005701927584595978 | 0.014189936220645905 | -0.006218409165740013 | 0.00967995636165142 | -0.03088236041367054 | -0.01986866071820259 | 0.04680478945374489 | 0.02245364896953106 | 0.024062391370534897 | -0.007981838658452034 | 0.015303680673241615 | -0.022976147010922432 | -0.013165565207600594 | 0.0030524861067533493 | 0.025437384843826294 | -0.00886871013790369 | -0.0004945680848322809 | -0.005709661636501551 | 0.02254989743232727 | -0.004936227574944496 | 0.034237343817949295 | -0.006459033116698265 | -0.01871366612613201 | 0.02602863311767578 | 0.006878406275063753 | 0.0032020166981965303 | -0.021284904330968857 | -0.019511161372065544 | 0.0032879537902772427 | -0.019992409273982048 | -0.02245364896953106 | 0.02245364896953106 | -0.005396850407123566 | -0.009666206315159798 | 0.013103690929710865 | 0.004252168349921703 | -0.03500734269618988 | -0.018768664449453354 | -0.004114668816328049 | -0.011433073319494724 | -0.026331130415201187 | -0.005496537778526545 | -0.017709920182824135 | -0.006434971000999212 | 0.01393556222319603 | 0.011075574904680252 | -0.016169926151633263 | 0.002559207146987319 | 0.03277985006570816 | 0.004393104929476976 | 0.004369042813777924 | -0.013564313761889935 | -0.012072445824742317 | 0.047437284141778946 | 0.008215587586164474 | 0.00824308767914772 | -0.0016267895698547363 | -0.02749987505376339 | 0.016279926523566246 | -0.02931486815214157 | 0.001474680844694376 | 0.0019215538632124662 | -0.00846996158361435 | 0.0172699224203825 | 0.03717983141541481 | 0.008105588145554066 | -0.010099329054355621 | -0.010078703984618187 | 0.029177367687225342 | -0.007748090196400881 | 0.03833482787013054 | -0.010360578075051308 | -0.019744910299777985 | 0.014368684962391853 | -0.019387412816286087 | 0.022329898551106453 | 0.008112463168799877 | 0.002920143073424697 | 0.01828741654753685 | 0.01689867302775383 | 0.00743184145539999 | -0.01935991272330284 | 0.0031624857801944017 | -0.0005908176535740495 | 0.00016865157522261143 | 0.011522447690367699 | -0.03126735985279083 | -0.0068990313448011875 | 0.02870986983180046 | 0.0335223488509655 | 0.0002016299549723044 | 0.007589965593069792 | 0.0012056976556777954 | -0.006187472026795149 | 0.021037405356764793 | -0.03594233840703964 | 0.025891132652759552 | 6.235811451915652e-05 | -0.0008292931015603244 | 0.008380587212741375 | -0.003746858099475503 | -0.030249863862991333 | 0.01736617088317871 | 0.019689910113811493 | -0.006173721980303526 | 0.0314873568713665 | 0.04630979150533676 | -0.008903084322810173 | -0.026331130415201187 | 0.035034842789173126 | -0.010834950953722 | 0.010346828028559685 | 0.0011395261390134692 | 0.0020057721994817257 | 0.01335806492716074 | 0.020391156896948814 | -0.024612389504909515 | -0.6305171251296997 | -0.014231185428798199 | 0.010683701373636723 | -0.01296619139611721 | 0.01680242456495762 | 0.021326154470443726 | 0.024846138432621956 | -0.0009710893500596285 | -0.01893366500735283 | 0.011164949275553226 | -0.022467399016022682 | 0.01060120202600956 | 0.020336158573627472 | -0.014767433516681194 | -0.022756146267056465 | -0.033824846148490906 | 0.0008202697499655187 | -0.013983686454594135 | -0.013756812550127506 | -0.002727643819525838 | -0.01898866333067417 | 0.036327335983514786 | -0.005692474078387022 | -0.010834950953722 | 0.007589965593069792 | 0.015661180019378662 | 0.0010742138838395476 | -0.015221181325614452 | -0.00010258742986479774 | 0.012354318983852863 | -0.023828642442822456 | 0.04003981873393059 | 0.030112363398075104 | 0.012711817398667336 | 0.045402295887470245 | 0.0024062390439212322 | -0.012347443960607052 | 0.005575599614530802 | 0.004843415692448616 | 0.023773642256855965 | -0.023168645799160004 | -0.010119954124093056 | 0.02221990004181862 | 0.012649943120777607 | -0.0036918583791702986 | -0.002722487784922123 | 0.010889951139688492 | 0.0034134220331907272 | -0.0016757736448198557 | 0.014148686081171036 | 0.004881227854639292 | 0.012952441349625587 | -0.00967995636165142 | -0.02287989668548107 | 0.006304346490651369 | 0.014671184122562408 | 0.036327335983514786 | -0.003387640928849578 | -0.0022378023713827133 | 0.01203807070851326 | -0.003160767024382949 | 0.021174903959035873 | -0.012258069589734077 | -0.031872354447841644 | -0.019511161372065544 | 0.021147403866052628 | -0.002184521406888962 | -0.013963062316179276 | 0.031652357429265976 | -0.016843674704432487 | 0.002064209431409836 | 0.021271154284477234 | -0.041607312858104706 | 0.02125740423798561 | 0.013337439857423306 | 0.04380730167031288 | 0.003370453603565693 | 0.0031693605706095695 | 0.0027053002268075943 | 0.010174954310059547 | 0.008091838099062443 | 0.013440564274787903 | 0.000412283290643245 | -0.00974870566278696 | 0.03297235071659088 | 0.024928636848926544 | -0.017668670043349266 | 0.022206149995326996 | -0.018163667991757393 | 0.002167333848774433 | 0.014561183750629425 | -0.01030557882040739 | -0.014726183377206326 | -0.01801241934299469 | 0.014657434076070786 | 0.003475296776741743 | -0.008215587586164474 | 0.017297422513365746 | 0.022618647664785385 | -0.00677184434607625 | -2.665393185452558e-05 | -0.006080910097807646 | 0.00997557956725359 | -0.010566826909780502 | 0.035117343068122864 | -0.015221181325614452 | -0.001542571117170155 | 0.020349908620119095 | 0.021312404423952103 | -0.01750367134809494 | 0.0015778053784742951 | -0.013550563715398312 | -0.020817406475543976 | -0.012044945731759071 | -0.005482787732034922 | -0.030992360785603523 | -0.004733416251838207 | 0.021449903026223183 | -0.0008026526193134487 | -0.01234056893736124 | -0.002770612481981516 | 0.0051596639677882195 | -0.0006153096910566092 | -0.004014981910586357 | -0.01446493435651064 | 0.02638613060116768 | 0.02061115764081478 | -0.010518702678382397 | -0.0012667130213230848 | -0.00035341636976227164 | -0.0022653022315353155 | 0.013804937712848186 | 0.019896160811185837 | -0.00458216667175293 | -0.0031934231519699097 | 0.009198708459734917 | -0.0011180418077856302 | -0.014671184122562408 | 0.015826178714632988 | -0.026881128549575806 | -0.011164949275553226 | 0.0038156076334416866 | 0.004740291275084019 | -0.012333693914115429 | 0.006190909538418055 | -0.010979325510561466 | 0.0054724751971662045 | -0.013406189158558846 | -0.047162286937236786 | 0.00010280226706527174 | -0.0026142068672925234 | -0.01973116025328636 | -0.018906164914369583 | -0.006819969043135643 | 0.013069315813481808 | -0.013688063248991966 | 0.007617465686053038 | -0.021559903398156166 | -0.01773742027580738 | -0.014272435568273067 | -0.003220923012122512 | 0.01342681422829628 | -0.03486984223127365 | -0.003250141628086567 | 0.003516546683385968 | -4.734597678179853e-05 | 0.03665733337402344 | -0.017297422513365746 | 0.012203069403767586 | -0.022893646731972694 | 0.0007111295708455145 | -0.03990231826901436 | -0.02972736582159996 | 0.017929919064044952 | -0.028352372348308563 | 0.008531836792826653 | -0.018493667244911194 | -0.013041815720498562 | -0.005884973332285881 | 0.013330564834177494 | 0.011439948342740536 | 0.00047609160537831485 | -0.008119338192045689 | 0.014891183003783226 | 0.012869942001998425 | -0.002758581191301346 | 0.022151149809360504 | 0.032944850623607635 | -0.02939736656844616 | 0.018122417852282524 | 0.0026434254832565784 | -0.0034563906956464052 | -0.008270587772130966 | -0.0030421738047152758 | 0.005744036752730608 | -0.007204967550933361 | -0.0022653022315353155 | 0.0058437236584723 | -0.007191217504441738 | 0.009762455709278584 | 0.016004927456378937 | -0.026592379435896873 | 0.013488689437508583 | -0.002468113787472248 | 0.014973682351410389 | -0.027279876172542572 | 0.017558671534061432 | -0.02699112705886364 | 0.02125740423798561 | -7.669887418160215e-05 | 0.008813709951937199 | -0.02223365008831024 | -0.011769946664571762 | -0.01764116995036602 | 0.01662367396056652 | 0.027802374213933945 | -0.0006866375333629549 | 0.006548407953232527 | -0.006410908419638872 | -0.00034160001087002456 | -0.004843415692448616 | -0.008971834555268288 | 0.005970910657197237 | 0.024199889972805977 | -0.02360864356160164 | 0.015001182444393635 | 0.013138066045939922 | -0.004719666205346584 | 0.017888668924570084 | -0.017146172001957893 | -0.0023959267418831587 | 0.029892364516854286 | 0.03143235668540001 | 0.02120240405201912 | 0.005108101759105921 | -0.03129485994577408 | 0.025918632745742798 | -0.0038121703546494246 | 0.022989895194768906 | -0.012808066792786121 | 0.014767433516681194 | 0.02212364971637726 | 0.010635577142238617 | 0.011742446571588516 | -0.006984968204051256 | 0.008813709951937199 | 0.020116159692406654 | 0.015936177223920822 | -0.006434971000999212 | 0.019662411883473396 | -0.003019830211997032 | 0.004953415133059025 | -0.02329239435493946 | 0.014588683843612671 | 0.002377020427957177 | -0.017283672466874123 | -0.027101127430796623 | -0.0070537179708480835 | 0.04122231528162956 | 0.006871531251817942 | 0.007768714800477028 | -0.00800933875143528 | -0.009666206315159798 | -0.024337390437722206 | 0.026331130415201187 | -0.014973682351410389 | -0.017517421394586563 | -0.03536484017968178 | 0.0033206099178642035 | -4.33378181696753e-06 | -0.00653809541836381 | -0.005919348448514938 | -0.0002500769915059209 | 0.013248065486550331 | 0.007115592714399099 | -0.002091709291562438 | 0.01699492335319519 | -0.01330993976444006 | -0.012093069963157177 | -5.145484465174377e-05 | -0.03533734008669853 | -0.008607461117208004 | 0.021958651021122932 | -0.01176307164132595 | -0.010779951699078083 | 0.02088615484535694 | -0.0016465550288558006 | -0.006421220954507589 | -0.009542456828057766 | 0.020253658294677734 | 0.017214922234416008 | 0.013976811431348324 | -0.018094917759299278 | -0.006637782324105501 | 0.00391185749322176 | 0.021229904145002365 | 0.054009754210710526 | -0.037207331508398056 | 0.03495234251022339 | -0.004011544398963451 | 0.017063673585653305 | -0.017929919064044952 | -0.020308658480644226 | -0.008139963261783123 | 0.008380587212741375 | 0.012938691303133965 | 0.012326818890869617 | 0.0024595202412456274 | -0.007321842014789581 | -0.01025745365768671 | 0.007706840056926012 | -0.002136396476998925 | -0.005376225803047419 | 0.01462993398308754 | 0.030084863305091858 | -0.015399930067360401 | -0.010566826909780502 | 0.013674313202500343 | 0.018067417666316032 | 0.011818071827292442 | -0.013131191022694111 | -0.040864814072847366 | -0.03800482675433159 | 0.014643684029579163 | 0.12990941107273102 | -0.0038327951915562153 | -0.003269047709181905 | 0.008236212655901909 | 0.0022549896966665983 | 0.02073490619659424 | -0.01889241486787796 | -0.009308707900345325 | 0.012423069216310978 | -0.014011186547577381 | 0.020253658294677734 | 0.0006823406438343227 | -0.0006260518566705287 | -0.008023088797926903 | 0.030799860134720802 | -0.021834900602698326 | -0.013000566512346268 | -0.02041865698993206 | -0.015179931186139584 | -0.0043827928602695465 | 0.01597742736339569 | 0.023031145334243774 | 0.0007201529806479812 | 0.011054949834942818 | 0.018727416172623634 | -0.017654919996857643 | 0.04949977621436119 | 0.014203685335814953 | 0.0009994485881179571 | -0.018603665754199028 | -0.016128677874803543 | -0.00021699120406992733 | -0.008463086560368538 | 0.01078682579100132 | -0.01695367321372032 | -0.01060120202600956 | 0.009026833809912205 | 0.027472374960780144 | 0.016651174053549767 | -0.01564742997288704 | 0.006036222912371159 | -0.0037571704015135765 | 0.008263712748885155 | -0.03156985715031624 | 0.014519934542477131 | -0.0024784263223409653 | -0.020061159506440163 | -0.004922477528452873 | 0.01560617983341217 | -0.007878714241087437 | 0.05293726176023483 | 0.00023933485499583185 | 0.0038568575400859118 | -0.01759991981089115 | 0.027293626219034195 | -0.005238726269453764 | -0.02245364896953106 | 0.012656818144023418 | -0.008016213774681091 | -0.005884973332285881 | -0.0065655955113470554 | -0.0331648513674736 | -0.00847683660686016 | -0.004826228134334087 | -0.03357734903693199 | -0.02972736582159996 | -0.02397989109158516 | -8.405723929172382e-05 | -0.0039840443059802055 | -0.016252426430583 | -0.0033893596846610308 | -0.005847161170095205 | -0.010339953005313873 | 0.011446823365986347 | 0.05070976912975311 | 0.01574367843568325 | 0.0024956136476248503 | 0.002751706400886178 | 0.025629883632063866 | -0.004186856094747782 | 0.023278644308447838 | -0.025011137127876282 | -0.006919656414538622 | -0.02149115316569805 | 0.006857781670987606 | 0.016004927456378937 | 0.005493100266903639 | -0.024791138246655464 | -0.0012323381379246712 | 0.005128726828843355 | -0.01254681870341301 | 0.012677442282438278 | 0.01744867116212845 | -0.009851830080151558 | -0.0030817047227174044 | -0.012539943680167198 | -0.00379154528491199 | 0.01893366500735283 | -0.0008323009242303669 | -0.00758309056982398 | 0.011955571360886097 | 0.031872354447841644 | -0.009948080405592918 | -0.02884737029671669 | 0.001235775649547577 | 0.014781183563172817 | -0.0006303486879914999 | 0.010147454217076302 | -0.006273409351706505 | -0.01828741654753685 | 0.04089231416583061 | -0.004393104929476976 | 0.003189985640347004 | 0.023883642628788948 | -0.017764920368790627 | 0.017847418785095215 | -0.0029992051422595978 | 0.019882410764694214 | -0.021738652139902115 | -0.02824237197637558 | 0.010779951699078083 | -0.043174803256988525 | 0.0335223488509655 | 0.0018012418877333403 | -0.033082351088523865 | 0.010752451606094837 | -0.013021191582083702 | -0.03330234810709953 | 0.0033292036969214678 | -0.01400431152433157 | -0.017297422513365746 | 0.004468729719519615 | -0.0181086678057909 | -0.009205583482980728 | -0.03580483794212341 | -0.011536197736859322 | -0.025808634236454964 | 0.024653637781739235 | -0.0008997615659609437 | -0.014011186547577381 | -0.006300908979028463 | -0.020776156336069107 | -0.0031349859200417995 | -0.004613104276359081 | -0.014959932304918766 | -0.034237343817949295 | -0.00667903246358037 | -0.0035268589854240417 | 0.004200606141239405 | 0.011261198669672012 | 0.02351239323616028 | 0.006892156321555376 | -0.010814325883984566 | -0.0008426134008914232 | 0.00022794818505644798 | -0.032889850437641144 | 0.008146838285028934 | 0.02829737216234207 | 0.022659897804260254 | 0.03580483794212341 | 0.027994873002171516 | 0.0015305399429053068 | 0.019387412816286087 | 0.006379971280694008 | 0.024928636848926544 | -0.0044652922078967094 | -0.013028065674006939 | 0.005761223845183849 | -0.01703617349267006 | -0.0023856142070144415 | -0.009597457014024258 | -0.0067924694158136845 | -0.012759942561388016 | 0.02139490284025669 | 0.004602791741490364 | 0.022494899109005928 | -0.0033326412085443735 | -0.02360864356160164 | 0.0022085837554186583 | -0.032889850437641144 | 0.0064315334893763065 | -0.006269971840083599 | -0.013784312643110752 | 0.032202355563640594 | 0.011089324951171875 | 0.005084039643406868 | 0.040809813886880875 | 0.006294033955782652 | 0.007184342481195927 | 0.009948080405592918 | 0.04152481257915497 | -0.013138066045939922 | 0.0122718196362257 | -0.011096199974417686 | -0.03357734903693199 | -0.0006922234315425158 | -0.01695367321372032 | -0.02806362323462963 | -0.00858683604747057 | 0.0026949879247695208 | 0.026509881019592285 | 0.012134320102632046 | -0.017104921862483025 | -0.01699492335319519 | 0.0014317122986540198 | 0.018782414495944977 | -0.013440564274787903 | -0.0009960110764950514 | 0.00905433390289545 | -0.009879330173134804 | -0.019937409088015556 | -0.016142427921295166 | -0.005224976222962141 | -0.01106182485818863 | 0.012539943680167198 | -0.0037262332625687122 | -0.004052794072777033 | 0.01680242456495762 | -0.036932334303855896 | -0.026262382045388222 | -0.019002413377165794 | -0.02069365605711937 | 0.021133653819561005 | 0.008091838099062443 | 0.013633063063025475 | 0.029782366007566452 | 0.01014057919383049 | -0.021779902279376984 | -0.00549997529014945 | 0.012629318051040173 | 0.014492434449493885 | 0.02241239883005619 | 0.031789857894182205 | 0.014451184310019016 | 0.014973682351410389 | -0.012436818331480026 | -0.019882410764694214 | -0.014588683843612671 | -0.029809866100549698 | 0.03640983626246452 | 0.009116209112107754 | 0.006837156601250172 | -0.016376176849007607 | -0.007514340803027153 | -0.007418091408908367 | 0.01828741654753685 | -0.00530060101300478 | -0.005809348542243242 | -0.009707456454634666 | -0.013901187106966972 | -0.025038637220859528 | 0.004021856933832169 | 0.0036059212870895863 | 0.013516188599169254 | 0.014382435008883476 | -0.01055307686328888 | -0.03264235332608223 | -0.007528090849518776 | -0.023209895938634872 | 0.008435586467385292 | 0.015496180392801762 | 0.003671233309432864 | -0.00972120650112629 | -0.008504336699843407 | 0.00328623503446579 | -0.009294957853853703 | -0.019043663516640663 | -0.006644657347351313 | 0.004049356561154127 | 0.031734857708215714 | -0.02292114682495594 | -0.009253707714378834 | -0.010401828214526176 | -0.0033910784404724836 | 0.016128677874803543 | -0.011048074811697006 | -0.011543072760105133 | -0.015812428668141365 | -0.0025557696353644133 | -0.027279876172542572 | 0.006954031065106392 | 0.014031811617314816 | 0.026193631812930107 | -0.013523063622415066 | -0.006582782603800297 | -0.004551229532808065 | -0.04366980120539665 | -0.01095182541757822 | 0.00308514223434031 | -0.01671992428600788 | -0.023347394540905952 | -0.024007391184568405 | -0.0006080050370655954 | 0.008222462609410286 | 0.0058196610771119595 | -0.015674928203225136 | 0.006995280738919973 | 0.019194914028048515 | 0.0003087290679104626 | 0.006761531811207533 | -0.040122319012880325 | 0.013447439298033714 | -0.054202254861593246 | -0.008208712562918663 | -0.017201172187924385 | -0.012725567445158958 | 0.015083681792020798 | 0.004386230371892452 | -0.0052318512462079525 | -0.03739983215928078 | 0.01621117629110813 | 0.009288082830607891 | 0.0012753066839650273 | 0.0010183547856286168 | 0.004905290435999632 | 0.01446493435651064 | 0.02004740945994854 | 0.014684933237731457 | -0.02319614589214325 | 0.023856142535805702 | -0.021051155403256416 | 0.022769896313548088 | 0.01801241934299469 | 0.001753976452164352 | -0.01095182541757822 | -0.0012177288299426436 | 0.029782366007566452 | 0.009006209671497345 | -0.004045919049531221 | 0.0011953852372244 | -0.01666492410004139 | 0.02925986796617508 | -0.012505568563938141 | 0.005661536939442158 | -0.01296619139611721 | -0.00154858676251024 | -0.014781183563172817 | 0.009343083016574383 | -0.0009341363911516964 | -0.009769330732524395 | 0.02319614589214325 | 0.02597363293170929 | 0.002260145964100957 | 0.008552460931241512 | -0.011742446571588516 | 0.003277641488239169 | -0.025959882885217667 | 0.015853678807616234 | -0.030524861067533493 | -0.02796737290918827 | -0.01157744787633419 | 0.04265230894088745 | 0.002951080445200205 | -0.02505238726735115 | -0.026124881580471992 | -0.007191217504441738 | -0.016871172934770584 | -0.010800575837492943 | -0.027389876544475555 | 0.022811146453022957 | 0.007596840616315603 | -0.0010346828494220972 | -0.008538711816072464 | 0.02611113153398037 | -0.002110615372657776 | 0.021656151860952377 | -0.005957160610705614 | -0.004905290435999632 | -0.004870915319770575 | 0.0006049972726032138 | -0.020074909552931786 | -0.009143708273768425 | -0.02139490284025669 | 0.0016199145466089249 | -0.01722867228090763 | 0.006857781670987606 | -0.02448863908648491 | 0.019882410764694214 | -0.00033988128416240215 | -0.001393040525726974 | -0.03398984670639038 | 0.026564879342913628 | 0.008284337818622589 | 0.02319614589214325 | 0.005465600173920393 | -0.005249038804322481 | -0.005585912149399519 | 0.016032427549362183 | -0.020294908434152603 | -0.002578113228082657 | -0.015303680673241615 | 0.010168079286813736 | 0.01852116547524929 | 0.007002155762165785 | -0.007369966711848974 | -0.0015992895932868123 | 0.00204874062910676 | -0.018741164356470108 | 0.02143615297973156 | 0.011075574904680252 | -0.02912236750125885 | 0.023966141045093536 | 0.034787341952323914 | 0.013096815906465054 | -0.02397989109158516 | 0.013296189717948437 | -0.021381152793765068 | -0.012368069030344486 | 0.01428618561476469 | -0.01215494517236948 | -0.01111682504415512 | -0.004413729999214411 | 0.014671184122562408 | 0.010931200347840786 | 0.0029029555153101683 | -0.0001269720814889297 | 0.01513868197798729 | -0.00824308767914772 | 0.025011137127876282 | 0.03459484502673149 | -0.0252311360090971 | 0.008896210230886936 | 0.003884357400238514 | -0.007699965033680201 | 0.024667387828230858 | -0.014588683843612671 | 0.0005461303517222404 | -0.02912236750125885 | 0.023347394540905952 | 0.032614853233098984 | -0.032339852303266525 | -0.04122231528162956 | 0.0027774875052273273 | -0.012374944053590298 | -0.019153663888573647 | 0.013639938086271286 | 0.19425912201404572 | -0.004114668816328049 | 0.02212364971637726 | 0.036602333188056946 | -0.012299319729208946 | -0.001428274787031114 | 0.02579488418996334 | 0.01754492148756981 | -0.03305485099554062 | 0.014506184495985508 | -0.003435765625908971 | -0.007672465406358242 | -0.015798678621649742 | -0.011879946105182171 | 0.01842491701245308 | -0.0032140479888767004 | -0.02129865437746048 | -0.04427479952573776 | -0.014327434822916985 | -0.018782414495944977 | -0.018438667058944702 | 0.011632447130978107 | -0.01076620165258646 | -0.008380587212741375 | 0.02292114682495594 | 0.019744910299777985 | 0.010944950394332409 | 0.016128677874803543 | -0.0079612135887146 | 0.008669335395097733 | -0.03046986274421215 | -0.01560617983341217 | -0.0027121752500534058 | 0.023443644866347313 | -0.018576165661215782 | -0.002423426602035761 | 0.034154847264289856 | -0.01852116547524929 | 0.003777795471251011 | 0.012148070149123669 | -0.00909558404237032 | -0.002572957193478942 | 0.008944334462285042 | -0.033769845962524414 | -0.04047981649637222 | 0.03726233169436455 | 0.012670567259192467 | -0.0064796581864356995 | -0.00532466359436512 | 0.02149115316569805 | -0.005018727388232946 | -0.03943482041358948 | 0.026867378503084183 | 0.006644657347351313 | 0.00824308767914772 | -0.01366056315600872 | 0.014712433330714703 | -0.005156226456165314 | -0.02851737104356289 | 0.024529889225959778 | -0.008676210418343544 | 0.04531979560852051 | -0.02542363479733467 | 0.03385234624147415 | -0.023278644308447838 | 0.019648661836981773 | -0.008793084882199764 | -0.021931150928139687 | 0.016444925218820572 | -0.02630363032221794 | 0.0009152302518486977 | -0.012512443587183952 | -0.00421435572206974 | -0.002782643772661686 | 0.0018785852007567883 | -0.009673081338405609 | 0.02305864542722702 | 0.01750367134809494 | 0.024021141231060028 | 0.0362173356115818 | -0.025781134143471718 | -0.031047359108924866 | 0.004080294165760279 | 0.0037262332625687122 | -0.008813709951937199 | -0.055577248334884644 | 0.025712383911013603 | -0.0002545886964071542 | -0.027761124074459076 | -0.0281048733741045 | 0.005486225243657827 | -0.01245744340121746 | -0.0045237294398248196 | -0.006593095138669014 | 0.006297471467405558 | 0.00789246428757906 | -0.01254681870341301 | 0.009184958413243294 | 0.015179931186139584 | -0.014148686081171036 | -0.016912423074245453 | -0.010917450301349163 | 0.007974963635206223 | 0.009143708273768425 | -0.002939049154520035 | -0.00047995877685025334 | 0.01897491328418255 | 0.02628988027572632 | 3.488509537419304e-05 | 0.021724902093410492 | 0.002801549853757024 | -0.024364890530705452 | 0.008579961024224758 | 0.007081218063831329 | -0.012938691303133965 | 0.01042245328426361 | -0.025712383911013603 | -0.04105731472373009 | 0.024296140298247337 | 0.0017471014289185405 | 0.007576215546578169 | -0.028957368806004524 | -0.008738085627555847 | 0.023691141977906227 | -0.01953866146504879 | -0.01758616976439953 | -0.023209895938634872 | 0.014368684962391853 | 0.01486368291079998 | -0.015427430160343647 | 0.008772460743784904 | -0.01959366165101528 | 0.0006741766119375825 | 0.002469832543283701 | -0.022288648411631584 | -0.0004208770114928484 | 0.006991843227297068 | -0.00547591270878911 | -0.009913705289363861 | -0.011453698389232159 | -0.007906214334070683 | 0.01412118598818779 | 0.014602433890104294 | -0.012588067911565304 | 0.007149967830628157 | -0.03327484801411629 | -0.0029631115030497313 | -0.01940116286277771 | -0.00789246428757906 | -0.016926173120737076 | 0.01254681870341301 | 0.009494331665337086 | 0.015248681418597698 | -0.012079320847988129 | 0.024048641324043274 | -0.008717460557818413 | -0.026647379621863365 | -0.008628086186945438 | 0.007479966152459383 | 0.007418091408908367 | -0.012299319729208946 | 0.006651532370597124 | 0.037757329642772675 | -0.023072395473718643 | -0.025409884750843048 | 0.013131191022694111 | -0.17621921002864838 | 0.040067318826913834 | 0.012677442282438278 | -0.015716178342700005 | 0.030909860506653786 | -0.011797446757555008 | 0.04834477975964546 | 0.021463653072714806 | -0.03374234586954117 | 0.0010656202211976051 | 0.013440564274787903 | 0.007624340709298849 | -0.01578492857515812 | -0.008298087865114212 | -0.0012521037133410573 | -0.032669853419065475 | -0.004228105768561363 | 0.024186139926314354 | 0.006177159491926432 | 0.006115284748375416 | 0.030909860506653786 | 0.006355908699333668 | 0.011247449554502964 | -0.03209235519170761 | -0.004427480045706034 | 0.016403675079345703 | -0.001406790572218597 | -0.023347394540905952 | 0.002571238437667489 | -0.0019181163515895605 | 0.0027448313776403666 | 0.004410292487591505 | 0.02536863461136818 | -0.010738701559603214 | 0.036327335983514786 | -0.0033309224527329206 | -0.003932482097297907 | -0.013158690184354782 | -0.0027482688892632723 | 0.003908419981598854 | 0.004482479766011238 | 0.007858089171350002 | 0.0010475734015926719 | -0.02806362323462963 | 0.0061324723064899445 | -0.005493100266903639 | -0.018809914588928223 | -0.008593711070716381 | -0.02045990712940693 | -0.027609875425696373 | -0.013571188785135746 | -0.019208664074540138 | 0.03363234922289848 | 0.019896160811185837 | -0.0009272614261135459 | 0.01462993398308754 | -0.004413729999214411 | 0.0015013213269412518 | -0.0010879638139158487 | -0.0011541354469954967 | 0.004128418862819672 | -0.035309839993715286 | -0.00046320102410390973 | 0.0049706026911735535 | -0.013942437246441841 | -0.02634488046169281 | -0.00963183119893074 | 0.003114360850304365 | 0.002916705561801791 | 0.010477452538907528 | -0.010154329240322113 | -0.0003733967605512589 | 0.0005615990376099944 | -0.01042245328426361 | 0.005008414853364229 | 0.021889900788664818 | -0.0122718196362257 | 0.017146172001957893 | 0.012024320662021637 | 0.016321176663041115 | -0.01703617349267006 | 0.028352372348308563 | -0.02393864095211029 | 0.003435765625908971 | -0.001983428606763482 | 0.00010043899965239689 | -0.00549997529014945 | 0.01973116025328636 | 0.011096199974417686 | -0.016651174053549767 | 0.007191217504441738 | 0.003475296776741743 | 0.00596059812232852 | -0.00910245906561613 | 0.027582375332713127 | 0.015014932490885258 | -0.027211127802729607 | 0.0025798319838941097 | 0.003315453650429845 | -0.020817406475543976 | 0.01516618113964796 | 0.009315582923591137 | -0.019552411511540413 | 0.008903084322810173 | 0.00990683026611805 | 0.01791616901755333 | -0.00394623214378953 | 0.047519784420728683 | 0.004056231584399939 | -0.0017634294927120209 | -0.013990561477839947 | 0.028324872255325317 | 0.020253658294677734 | 0.01824616827070713 | 0.015564929693937302 | 0.034099847078323364 | 0.009851830080151558 | -0.02573988400399685 | 0.05026977136731148 | -0.012010570615530014 | 0.011446823365986347 | -0.0026107693556696177 | -0.011158074252307415 | -0.00454779202118516 | -0.002019522013142705 | -0.019208664074540138 | -0.09861455112695694 | -0.003434046870097518 | 0.003643733449280262 | 0.008710585534572601 | -0.035914838314056396 | -9.071735985344276e-05 | 0.023828642442822456 | 0.012065570801496506 | -0.0020968655589967966 | 0.03805982694029808 | 0.001032104715704918 | -0.02149115316569805 | 0.027279876172542572 | 0.010525577701628208 | 0.0208311565220356 | 0.0061187222599983215 | 0.015262430533766747 | -0.009246833622455597 | -0.021821150556206703 | 0.02370489202439785 | -0.00805746391415596 | 0.004479042254388332 | -0.0064315334893763065 | -0.010979325510561466 | 0.028214871883392334 | -0.028091123327612877 | -0.012842441909015179 | 0.004960290156304836 | 0.030057363212108612 | -0.0009306989377364516 | 0.0024784263223409653 | 0.00898558460175991 | 0.01634867675602436 | -0.013062440790235996 | 0.01621117629110813 | -0.0026451442390680313 | -0.009968704544007778 | -0.021917400881648064 | 0.0287923701107502 | -0.05967472866177559 | -0.0023907704744488 | -0.01847991719841957 | -0.031239857897162437 | -0.029204867780208588 | 0.03640983626246452 | 0.004197168629616499 | -0.020679906010627747 | 0.007253092247992754 | 0.018122417852282524 | -0.003358422312885523 | 0.015496180392801762 | 0.009948080405592918 | -0.023553643375635147 | -0.01574367843568325 | 0.025437384843826294 | -0.02518988586962223 | 0.012698067352175713 | 0.010168079286813736 | -0.02620738185942173 | 0.0018012418877333403 | 0.002334051998332143 | -0.014794932678341866 | -0.018507415428757668 | 0.04177230969071388 | 0.03156985715031624 | 0.020487407222390175 | -0.012746192514896393 | -0.011639322154223919 | -0.01568867824971676 | 0.00997557956725359 | 0.0014411653392016888 | 0.014134936034679413 | -0.010779951699078083 | 0.002859987085685134 | -0.017861168831586838 | -0.01319306530058384 | -0.032009854912757874 | -0.0033498285338282585 | -0.0054724751971662045 | -0.003636858658865094 | 0.00986558012664318 | -0.023828642442822456 | -0.01746242120862007 | -0.00044171675108373165 | 0.015936177223920822 | 0.015551179647445679 | -0.015124931931495667 | 0.012175570242106915 | -0.01676117442548275 | -0.02407614141702652 | -0.0059399730525910854 | 0.023966141045093536 | 0.006978093646466732 | 0.015482430346310139 | -0.01893366500735283 | 0.018438667058944702 | -0.004066544119268656 | 0.019566161558032036 | 0.03668483346700668 | 0.016279926523566246 | -0.035447340458631516 | -0.026001133024692535 | -0.05873973295092583 | 0.017063673585653305 | 0.005671849474310875 | -0.015399930067360401 | 0.00030958844581618905 | -0.024804888293147087 | 0.011268073692917824 | -0.021752402186393738 | -0.0050771646201610565 | 0.0122718196362257 | -0.0009728081058710814 | 0.013371814973652363 | -0.005613412242382765 | 0.034154847264289856 | 0.0062871589325368404 | -0.023127395659685135 | 0.0062390342354774475 | 0.007974963635206223 | 0.005194039084017277 | 0.014231185428798199 | -0.005080602131783962 | -0.005259351339191198 | 0.024928636848926544 | -0.02227489836513996 | -0.012560567818582058 | 0.027376126497983932 | -0.017434921115636826 | 0.04014981910586357 | -0.004595916718244553 | -0.004936227574944496 | 0.026551129296422005 | -0.013048690743744373 | 0.003098892280831933 | 0.03481484204530716 | -0.002939049154520035 | 0.004265918396413326 | 0.0032552978955209255 | 0.022756146267056465 | 0.023553643375635147 | -0.023113645613193512 | -0.024062391370534897 | -0.01435493491590023 | 0.027747374027967453 | 0.004767790902405977 | -0.008731210604310036 | -0.00373310805298388 | -0.010704326443374157 | -0.0007033952861092985 | 0.013949312269687653 | 0.016183676198124886 | -0.0011781977955251932 | 0.02773362398147583 | -0.002531707286834717 | -0.017806168645620346 | -0.0037124832160770893 | -0.007809964474290609 | 0.01740742102265358 | 0.011247449554502964 | 0.00026962769334204495 | -0.048124782741069794 | 0.027211127802729607 | 0.01759991981089115 | 0.0026657693088054657 | 0.0037812329828739166 | 0.015111181885004044 | -0.011219949461519718 | -0.01680242456495762 | 0.012835566885769367 | 0.0009212458389811218 | -0.025176135823130608 | -0.00329826632514596 | 0.010147454217076302 | 0.02139490284025669 | -0.013028065674006939 | 0.013956187292933464 | -0.01963491179049015 | -0.01967616192996502 | -0.017077423632144928 | -0.01852116547524929 | 0.004228105768561363 | 0.035914838314056396 | 0.009157458320260048 | -0.06253471970558167 | 0.024516139179468155 | 0.00400466937571764 | 0.022563647478818893 | 0.00951495673507452 | 0.006177159491926432 | 0.0022498336620628834 | 0.012189320288598537 | -0.0032759227324277163 | -0.011013700626790524 | 0.016706174239516258 | 0.0029149868059903383 | -0.0074387164786458015 | 0.020336158573627472 | 0.0018906164914369583 | -0.02111990377306938 | 0.015221181325614452 | 0.026881128549575806 | 0.013756812550127506 | 0.007768714800477028 | 0.020391156896948814 | -0.014011186547577381 | -0.038087327033281326 | -0.005750911310315132 | -0.02754112519323826 | -0.03239485248923302 | -0.0035715464036911726 | -0.011213074438273907 | 0.0042246682569384575 | -0.017847418785095215 | 0.008765585720539093 | 0.0065140328370034695 | -0.02171115204691887 | 0.018259918317198753 | -0.006991843227297068 | -0.00840808730572462 | -0.025176135823130608 | 0.004454979673027992 | 0.006613720208406448 | 0.011233699508011341 | 0.016279926523566246 | -0.016266176477074623 | -0.0314873568713665 | 0.006758094299584627 | 0.0033034225925803185 | -0.0067065320909023285 | 0.008717460557818413 | -0.01164619717746973 | -0.012574317865073681 | -0.011522447690367699 | -0.009769330732524395 | -0.007149967830628157 | -0.01568867824971676 | 0.009810580871999264 | 0.019854910671710968 | -0.005087477155029774 | -0.032807350158691406 | 0.04441229999065399 | -0.0065655955113470554 | -0.015936177223920822 | 0.008538711816072464 | 0.016362426802515984 | 0.0348973423242569 | -0.001806398038752377 | 0.0017634294927120209 | -0.017957419157028198 | -0.009274332784116268 | -0.0015228056581690907 | -0.02628988027572632 | -0.002689831657335162 | -0.03731733188033104 | -0.03398984670639038 | 0.01527618058025837 | -0.023168645799160004 | -0.01607367768883705 | -0.0135436886921525 | 0.005465600173920393 | 0.01671992428600788 | 0.01865866594016552 | 0.0028548308182507753 | -0.001274447306059301 | -0.019153663888573647 | -0.015674928203225136 | 0.015014932490885258 | -0.012670567259192467 | -0.00842871144413948 | -0.04353230446577072 | 0.007796214893460274 | 0.011886821128427982 | -0.04218481108546257 | -0.014767433516681194 | 0.006569033022969961 | -0.00963183119893074 | -0.011027449741959572 | 0.009961829520761967 | 0.02125740423798561 | -0.002842799760401249 | -0.0033446722663939 | 0.02157365158200264 | -0.03264235332608223 | -0.002664050552994013 | 0.029094869270920753 | 0.0015253836754709482 | -0.007005593273788691 | -0.021876150742173195 | -0.037564828991889954 |
#+begin_src jupyter-python :results none
  import ast

  # 将字符串转换为向量
  df_embedded["embedding_vec"] = df_embedded["embedding"].apply(ast.literal_eval)
#+end_src

#+begin_src jupyter-python
len(df_embedded["embedding_vec"][0])
#+end_src

#+RESULTS:
: 1536
#+begin_src jupyter-python
  df_embedded.head(2)
#+end_src

#+RESULTS:
#+begin_example
       ProductId         UserId  Score                     Summary  \
  12  B000K8T3OQ  AK43Y4WT6FFR3      1  Broken in a million pieces   
  13  B0051C0J6M  AWFA8N9IXELVH      1       Deceptive description   

                                                   Text  \
  12  Chips were broken into small pieces. Problem i...   
  13  On Oct 9 I ordered from a different vendor the...   

                                               combined  n_tokens  \
  12  Title: Broken in a million pieces; Content: Ch...       120   
  13  Title: Deceptive description; Content: On Oct ...       157   

                                              embedding  \
  12  [-0.0005399271612986922, -0.004124758299440145...   
  13  [0.0068963742814958096, 0.0167608093470335, -0...   

                                          embedding_vec  
  12  [-0.0005399271612986922, -0.004124758299440145...  
  13  [0.0068963742814958096, 0.0167608093470335, -0...  
#+end_example

* 3. 使用 t-SNE 可视化 1536 维 Embedding 美食评论

#+begin_src jupyter-python :results none
  # 导入 NumPy 包，NumPy 是 Python 的一个开源数值计算扩展。这种工具可用来存储和处理大型矩阵，
  # 比 Python 自身的嵌套列表（nested list structure)结构要高效的多。
  import numpy as np
  # 从 matplotlib 包中导入 pyplot 子库，并将其别名设置为 plt。
  # matplotlib 是一个 Python 的 2D 绘图库，pyplot 是其子库，提供了一种类似 MATLAB 的绘图框架。
  import matplotlib.pyplot as plt
  import matplotlib

  # 从 sklearn.manifold 模块中导入 TSNE 类。
  # TSNE (t-Distributed Stochastic Neighbor Embedding) 是一种用于数据可视化的降维方法，尤其擅长处理高维数据的可视化。
  # 它可以将高维度的数据映射到 2D 或 3D 的空间中，以便我们可以直观地观察和理解数据的结构。
  from sklearn.manifold import TSNE
#+end_src

#+begin_src jupyter-python
  type(df_embedded["embedding_vec"])
#+end_src

#+RESULTS:
: pandas.core.series.Series
#+begin_src jupyter-python
  # 首先，确保你的嵌入向量都是等长的
  assert df_embedded['embedding_vec'].apply(len).nunique() == 1
#+end_src

#+RESULTS:

#+begin_src jupyter-python :results none
  # 将嵌入向量列表转换为二维 numpy 数组
  matrix = np.vstack(df_embedded['embedding_vec'].values)
#+end_src

#+begin_src jupyter-python :results none
  # 创建一个 t-SNE 模型，t-SNE 是一种非线性降维方法，常用于高维数据的可视化。
  # n_components 表示降维后的维度（在这里是2D）
  # perplexity 可以被理解为近邻的数量
  # random_state 是随机数生成器的种子
  # init 设置初始化方式
  # learning_rate 是学习率。
  tsne = TSNE(n_components=2, perplexity=15, random_state=42, init='random', learning_rate=200)
#+end_src

#+begin_src jupyter-python :results none
  # 使用 t-SNE 对数据进行降维，得到每个数据点在新的2D空间中的坐标
  vis_dims = tsne.fit_transform(matrix)
#+end_src

#+RESULTS:

#+begin_src jupyter-python :results none
  # 定义了五种不同的颜色，用于在可视化中表示不同的等级
  colors = ["red", "darkorange", "gold", "turquoise", "darkgreen"]
#+end_src

#+begin_src jupyter-python
  # 从降维后的坐标中分别获取所有数据点的横坐标和纵坐标
  x = [x for x,y in vis_dims]
  y = [y for x,y in vis_dims]

  # 根据数据点的评分（减1是因为评分是从1开始的，而颜色索引是从0开始的）获取对应的颜色索引
  color_indices = df_embedded.Score.values - 1

  # 确保你的数据点和颜色索引的数量匹配
  assert len(vis_dims) == len(df_embedded.Score.values)
#+end_src

#+RESULTS:

#+begin_src jupyter-python :display :image/svg+xml
  # 创建一个基于预定义颜色的颜色映射对象
  colormap = matplotlib.colors.ListedColormap(colors)
  # 使用 matplotlib 创建散点图，其中颜色由颜色映射对象和颜色索引共同决定，alpha 是点的透明度
  plt.scatter(x, y, c=color_indices, cmap=colormap, alpha=0.3)

  # 为图形添加标题
  plt.title("Amazon ratings visualized in language using t-SNE")
  plt.plot()
#+end_src

#+RESULTS:
:RESULTS:

[[file:./.ob-jupyter/554394027f1c7c96342ac0a1fdbca4d4e6c04ec4.png]]
:END:

*t-SNE降维后，评论大致分为3个大类。*

* 4. 使用 K-Means 聚类，然后使用 t-SNE 可视化

#+begin_src jupyter-python :results none
  import numpy as np
  # 从 scikit-learn中导入 KMeans 类。KMeans 是一个实现 K-Means 聚类算法的类。
  from sklearn.cluster import KMeans

  # np.vstack 是一个将输入数据堆叠到一个数组的函数（在垂直方向）。
  # 这里它用于将所有的 ada_embedding 值堆叠成一个矩阵。
  # matrix = np.vstack(df.ada_embedding.values)

  # 定义要生成的聚类数。
  n_clusters = 4

  # 创建一个 KMeans 对象，用于进行 K-Means 聚类。
  # n_clusters 参数指定了要创建的聚类的数量；
  # init 参数指定了初始化方法（在这种情况下是 'k-means++'）；
  # random_state 参数为随机数生成器设定了种子值，用于生成初始聚类中心。
  # n_init=10 消除警告 'FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4'
  kmeans = KMeans(n_clusters = n_clusters, init='k-means++', random_state=42, n_init=10)

  # 使用 matrix（我们之前创建的矩阵）来训练 KMeans 模型。这将执行 K-Means 聚类算法。
  kmeans.fit(matrix)

  # kmeans.labels_ 属性包含每个输入数据点所属的聚类的索引。
  # 这里，我们创建一个新的 'Cluster' 列，在这个列中，每个数据点都被赋予其所属的聚类的标签。
  df_embedded['Cluster'] = kmeans.labels_
#+end_src

#+begin_src jupyter-python
  df_embedded['Cluster']
#+end_src

#+RESULTS:
#+begin_example
  12     1
  13     1
  14     1
  15     3
  16     1
        ..
  447    2
  436    2
  437    0
  438    2
  439    1
  Name: Cluster, Length: 1000, dtype: int32
#+end_example
#+begin_src jupyter-python
  df_embedded.head(2)
#+end_src

#+RESULTS:
#+begin_example
       ProductId         UserId  Score                     Summary  \
  12  B000K8T3OQ  AK43Y4WT6FFR3      1  Broken in a million pieces   
  13  B0051C0J6M  AWFA8N9IXELVH      1       Deceptive description   

                                                   Text  \
  12  Chips were broken into small pieces. Problem i...   
  13  On Oct 9 I ordered from a different vendor the...   

                                               combined  n_tokens  \
  12  Title: Broken in a million pieces; Content: Ch...       120   
  13  Title: Deceptive description; Content: On Oct ...       157   

                                              embedding  \
  12  [-0.0005399271612986922, -0.004124758299440145...   
  13  [0.0068963742814958096, 0.0167608093470335, -0...   

                                          embedding_vec  Cluster  
  12  [-0.0005399271612986922, -0.004124758299440145...        1  
  13  [0.0068963742814958096, 0.0167608093470335, -0...        1  
#+end_example

#+begin_src jupyter-python :display :image/svg+xml
  # 首先为每个聚类定义一个颜色。
  colors = ["red", "green", "blue", "purple"]

  # 然后，你可以使用 t-SNE 来降维数据。这里，我们只考虑 'embedding_vec' 列。
  tsne_model = TSNE(n_components=2, random_state=42)
  vis_data = tsne_model.fit_transform(matrix)

  # 现在，你可以从降维后的数据中获取 x 和 y 坐标。
  x = vis_data[:, 0]
  y = vis_data[:, 1]

  # 'Cluster' 列中的值将被用作颜色索引。
  color_indices = df_embedded['Cluster'].values

  # 创建一个基于预定义颜色的颜色映射对象
  colormap = matplotlib.colors.ListedColormap(colors)

  # 使用 matplotlib 创建散点图，其中颜色由颜色映射对象和颜色索引共同决定
  plt.scatter(x, y, c=color_indices, cmap=colormap)

  # 为图形添加标题
  plt.title("Clustering visualized in 2D using t-SNE")

  # 显示图形
  plt.show()
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/c03401fb11b81cbb3ba997ca87a1c83f97f29fa3.png]]

*K-MEANS
聚类可视化效果，4类（官方介绍：一个专注于狗粮，一个专注于负面评论，两个专注于正面评论）。*

* 5. 使用 Embedding 进行文本搜索

[[file:images/cosine.png]]

#+begin_src jupyter-python :results none
# cosine_similarity 函数计算两个嵌入向量之间的余弦相似度。
def cosine_similarity(a, b):
    return np.dot(a, b) / (np.linalg.norm(a) * np.linalg.norm(b))
#+end_src

#+begin_src jupyter-python
  type(df_embedded["embedding_vec"][0])
#+end_src

#+RESULTS:
: list
#+begin_src jupyter-python :results none
  # 定义一个名为 search_reviews 的函数，
  # Pandas DataFrame 产品描述，数量，以及一个 pprint 标志（默认值为 True）。
  def search_reviews(df, product_description, n=3, pprint=True):
      product_embedding = embedding_text(product_description)
    
      df["similarity"] = df.embedding_vec.apply(lambda x: cosine_similarity(x, product_embedding))

      results = (
          df.sort_values("similarity", ascending=False)
          .head(n)
          .combined.str.replace("Title: ", "")
          .str.replace("; Content:", ": ")
      )
      if pprint:
          for r in results:
              print(r[:200])
              print()
      return results
#+end_src

#+begin_src jupyter-python
  # 使用 'delicious beans' 作为产品描述和 3 作为数量，
  # 调用 search_reviews 函数来查找与给定产品描述最相似的前3条评论。
  # 其结果被存储在 res 变量中。
  res = search_reviews(df_embedded, 'delicious beans', n=3)
#+end_src

#+RESULTS:
: Good Buy:  I liked the beans. They were vacuum sealed, plump and moist. Would recommend them for any use. I personally split and stuck them in some vodka to make vanilla extract. Yum!
: 
: Jamaican Blue beans:  Excellent coffee bean for roasting. Our family just purchased another 5 pounds for more roasting. Plenty of flavor and mild on acidity when roasted to a dark brown bean and befor
: 
: Delicious!:  I enjoy this white beans seasoning, it gives a rich flavor to the beans I just love it, my mother in law didn't know about this Zatarain's brand and now she is traying different seasoning
: 

#+begin_src jupyter-python
  res = search_reviews(df_embedded, 'dog food', n=3)
#+end_src

#+RESULTS:
: Healthy Dog Food:  This is a very healthy dog food. Good for their digestion. Also good for small puppies. My dog eats her required amount at every feeding.
: 
: Doggy snacks:  My dog loves these snacks. However they are made in China and as far as I am concerned, suspect!!!! I found an abundance of American made ,human grade chicken dog snacks. Just Google fo
: 
: Dogs Love Them!:  My Maltese and Cavalier King Charles love these treats!  I feel good about feeding them a healthier treat.<br />Not made in China!
: 

#+begin_src jupyter-python
  res = search_reviews(df_embedded, 'awful', n=5)
#+end_src

#+RESULTS:
: God Awful:  As a dabbler who enjoys spanning the entire spectrum of taste, I am more than willing to try anything once.  Both as a food aficionado and a lover of bacon, I just had to pick this up.  On
: 
: Disappointed:  The metal cover has severely disformed. And most of the cookies inside have been crushed into small pieces. Shopping experience is awful. I'll never buy it online again.
: 
: Just Bad:  Watery and unpleasant.  Like Yoohoo mixed with dirty dish water.  I find it quite odd that Keurig would release a product like this.  I'm sure they can come up with a decent hot chocolate a
: 
: Arrived in pieces:  Not pleased at all. When I opened the box, most of the rings were broken in pieces. A total waste of money.
: 
: Awesome:  They arrived before the expected time and were of fantastic quality. Would recommend to any one looking for a awesome treat
: 
